# UI-005: Responsive Layout & Navigation

**Task ID:** UI-005
**Phase:** Phase 1 - MVP
**Category:** UI
**Priority:** P0 (Critical - Foundation)
**Estimated Effort:** 2-3 days
**Dependencies:** UI-001, UI-002
**Status:** TO DO

---

## Overview

Create the responsive layout system and navigation structure for ClearSide. This includes the main app shell, header, navigation, and responsive breakpoints that work seamlessly across desktop, tablet, and mobile devices.

### Related Documentation
- **Requirements:** `docs/REQUIREMENTS.md` - Non-functional requirements
- **Product Vision:** `docs/01_product-vision.md` - Design philosophy
- **Kanban:** `docs/KANBAN.md` - Task UI-005

---

## Objectives

1. **App shell** with header, main content area, and footer
2. **Responsive grid system** for all screen sizes
3. **Navigation menu** (minimal - Home, About, Docs)
4. **Mobile hamburger menu** for small screens
5. **Sticky header** that stays visible on scroll
6. **Skip navigation link** for accessibility

---

## Acceptance Criteria

### Functional Requirements

- [ ] Layout works on mobile (320px+), tablet (768px+), desktop (1024px+)
- [ ] Navigation menu is accessible via keyboard
- [ ] Mobile menu opens/closes smoothly
- [ ] Skip to content link for screen readers
- [ ] Header remains sticky on scroll
- [ ] Main content area has max-width for readability
- [ ] Footer displays attribution and links

### Non-Functional Requirements

- [ ] Layout doesn't shift during load (CLS < 0.1)
- [ ] Animations are smooth (60fps)
- [ ] Touch targets are >= 44px on mobile
- [ ] Meets WCAG 2.1 AA standards

### Design Requirements

- [ ] Clean, minimal aesthetic
- [ ] Professional color palette
- [ ] Readable typography (16px base)
- [ ] Adequate white space

---

## Technical Specification

### App Layout Component

```typescript
// src/components/Layout/AppLayout.tsx

import React from 'react';
import { Header } from './Header';
import { Footer } from './Footer';
import { SkipLink } from './SkipLink';
import styles from './AppLayout.module.css';

interface AppLayoutProps {
  children: React.ReactNode;
}

export const AppLayout: React.FC<AppLayoutProps> = ({ children }) => {
  return (
    <div className={styles.appLayout}>
      <SkipLink href="#main-content">Skip to main content</SkipLink>
      <Header />
      <main id="main-content" className={styles.main}>
        {children}
      </main>
      <Footer />
    </div>
  );
};
```

### Header Component

```typescript
// src/components/Layout/Header.tsx

import React, { useState, useEffect } from 'react';
import { Link } from 'react-router-dom';
import { Navigation } from './Navigation';
import { MobileMenu } from './MobileMenu';
import { useMediaQuery } from '@/hooks/useMediaQuery';
import styles from './Header.module.css';

export const Header: React.FC = () => {
  const [isScrolled, setIsScrolled] = useState(false);
  const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false);
  const isMobile = useMediaQuery('(max-width: 768px)');

  useEffect(() => {
    const handleScroll = () => {
      setIsScrolled(window.scrollY > 10);
    };

    window.addEventListener('scroll', handleScroll);
    return () => window.removeEventListener('scroll', handleScroll);
  }, []);

  return (
    <header
      className={`${styles.header} ${isScrolled ? styles.scrolled : ''}`}
    >
      <div className={styles.container}>
        <Link to="/" className={styles.logo}>
          <span className={styles.logoText}>ClearSide</span>
          <span className={styles.tagline}>Think both sides</span>
        </Link>

        {isMobile ? (
          <>
            <button
              className={styles.hamburger}
              onClick={() => setIsMobileMenuOpen(true)}
              aria-label="Open menu"
              aria-expanded={isMobileMenuOpen}
            >
              <span className={styles.hamburgerLine} />
              <span className={styles.hamburgerLine} />
              <span className={styles.hamburgerLine} />
            </button>
            <MobileMenu
              isOpen={isMobileMenuOpen}
              onClose={() => setIsMobileMenuOpen(false)}
            />
          </>
        ) : (
          <Navigation />
        )}
      </div>
    </header>
  );
};
```

### Navigation Component

```typescript
// src/components/Layout/Navigation.tsx

import React from 'react';
import { NavLink } from 'react-router-dom';
import styles from './Navigation.module.css';

interface NavItem {
  label: string;
  href: string;
  external?: boolean;
}

const NAV_ITEMS: NavItem[] = [
  { label: 'Home', href: '/' },
  { label: 'How It Works', href: '/how-it-works' },
  { label: 'Examples', href: '/examples' },
  { label: 'Docs', href: '/docs' },
];

export const Navigation: React.FC = () => {
  return (
    <nav className={styles.navigation} aria-label="Main navigation">
      <ul className={styles.navList}>
        {NAV_ITEMS.map((item) => (
          <li key={item.href} className={styles.navItem}>
            {item.external ? (
              <a
                href={item.href}
                className={styles.navLink}
                target="_blank"
                rel="noopener noreferrer"
              >
                {item.label}
              </a>
            ) : (
              <NavLink
                to={item.href}
                className={({ isActive }) =>
                  `${styles.navLink} ${isActive ? styles.active : ''}`
                }
              >
                {item.label}
              </NavLink>
            )}
          </li>
        ))}
      </ul>
    </nav>
  );
};
```

### Mobile Menu Component

```typescript
// src/components/Layout/MobileMenu.tsx

import React, { useEffect } from 'react';
import { NavLink } from 'react-router-dom';
import { Button } from '@/components/ui/Button';
import styles from './MobileMenu.module.css';

interface MobileMenuProps {
  isOpen: boolean;
  onClose: () => void;
}

const NAV_ITEMS = [
  { label: 'Home', href: '/' },
  { label: 'How It Works', href: '/how-it-works' },
  { label: 'Examples', href: '/examples' },
  { label: 'Docs', href: '/docs' },
];

export const MobileMenu: React.FC<MobileMenuProps> = ({ isOpen, onClose }) => {
  // Lock body scroll when menu is open
  useEffect(() => {
    if (isOpen) {
      document.body.style.overflow = 'hidden';
    } else {
      document.body.style.overflow = '';
    }
    return () => {
      document.body.style.overflow = '';
    };
  }, [isOpen]);

  // Close on escape key
  useEffect(() => {
    const handleEscape = (e: KeyboardEvent) => {
      if (e.key === 'Escape') {
        onClose();
      }
    };

    if (isOpen) {
      document.addEventListener('keydown', handleEscape);
    }

    return () => document.removeEventListener('keydown', handleEscape);
  }, [isOpen, onClose]);

  if (!isOpen) return null;

  return (
    <>
      {/* Backdrop */}
      <div className={styles.backdrop} onClick={onClose} />

      {/* Menu */}
      <div className={styles.menu} role="dialog" aria-modal="true">
        <div className={styles.header}>
          <h2 className={styles.title}>Menu</h2>
          <Button
            variant="ghost"
            size="sm"
            onClick={onClose}
            aria-label="Close menu"
          >
            ✕
          </Button>
        </div>

        <nav className={styles.navigation}>
          <ul className={styles.navList}>
            {NAV_ITEMS.map((item) => (
              <li key={item.href} className={styles.navItem}>
                <NavLink
                  to={item.href}
                  className={({ isActive }) =>
                    `${styles.navLink} ${isActive ? styles.active : ''}`
                  }
                  onClick={onClose}
                >
                  {item.label}
                </NavLink>
              </li>
            ))}
          </ul>
        </nav>
      </div>
    </>
  );
};
```

### Skip Link Component

```typescript
// src/components/Layout/SkipLink.tsx

import React from 'react';
import styles from './SkipLink.module.css';

interface SkipLinkProps {
  href: string;
  children: React.ReactNode;
}

export const SkipLink: React.FC<SkipLinkProps> = ({ href, children }) => {
  return (
    <a href={href} className={styles.skipLink}>
      {children}
    </a>
  );
};
```

### Footer Component

```typescript
// src/components/Layout/Footer.tsx

import React from 'react';
import { Link } from 'react-router-dom';
import styles from './Footer.module.css';

export const Footer: React.FC = () => {
  const currentYear = new Date().getFullYear();

  return (
    <footer className={styles.footer}>
      <div className={styles.container}>
        <div className={styles.content}>
          <div className={styles.brand}>
            <p className={styles.tagline}>Think both sides. Decide with clarity.</p>
            <p className={styles.copyright}>
              © {currentYear} ClearSide. All rights reserved.
            </p>
          </div>

          <div className={styles.links}>
            <div className={styles.linkGroup}>
              <h3 className={styles.linkGroupTitle}>Product</h3>
              <ul className={styles.linkList}>
                <li><Link to="/how-it-works">How It Works</Link></li>
                <li><Link to="/examples">Examples</Link></li>
                <li><Link to="/pricing">Pricing</Link></li>
              </ul>
            </div>

            <div className={styles.linkGroup}>
              <h3 className={styles.linkGroupTitle}>Resources</h3>
              <ul className={styles.linkList}>
                <li><Link to="/docs">Documentation</Link></li>
                <li><Link to="/api">API</Link></li>
                <li><Link to="/blog">Blog</Link></li>
              </ul>
            </div>

            <div className={styles.linkGroup}>
              <h3 className={styles.linkGroupTitle}>Legal</h3>
              <ul className={styles.linkList}>
                <li><Link to="/privacy">Privacy</Link></li>
                <li><Link to="/terms">Terms</Link></li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </footer>
  );
};
```

### Media Query Hook

```typescript
// src/hooks/useMediaQuery.ts

import { useState, useEffect } from 'react';

export function useMediaQuery(query: string): boolean {
  const [matches, setMatches] = useState(false);

  useEffect(() => {
    const mediaQuery = window.matchMedia(query);
    setMatches(mediaQuery.matches);

    const handler = (e: MediaQueryListEvent) => setMatches(e.matches);
    mediaQuery.addEventListener('change', handler);

    return () => mediaQuery.removeEventListener('change', handler);
  }, [query]);

  return matches;
}
```

### Styling

```css
/* src/components/Layout/AppLayout.module.css */

.appLayout {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}

.main {
  flex: 1;
  width: 100%;
}

/* Global Container */
:global(.container) {
  width: 100%;
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 2rem;
}

@media (max-width: 768px) {
  :global(.container) {
    padding: 0 1rem;
  }
}
```

```css
/* src/components/Layout/Header.module.css */

.header {
  position: sticky;
  top: 0;
  z-index: 1000;
  background: var(--color-bg-primary);
  border-bottom: 1px solid var(--color-border);
  transition: box-shadow 0.2s ease;
}

.header.scrolled {
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 2rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  height: 64px;
}

.logo {
  display: flex;
  flex-direction: column;
  text-decoration: none;
  color: var(--color-text-primary);
}

.logoText {
  font-size: 1.25rem;
  font-weight: 700;
  letter-spacing: -0.02em;
}

.tagline {
  font-size: 0.75rem;
  color: var(--color-text-secondary);
  font-weight: 400;
}

.hamburger {
  display: flex;
  flex-direction: column;
  gap: 4px;
  background: none;
  border: none;
  padding: 0.5rem;
  cursor: pointer;
}

.hamburgerLine {
  width: 24px;
  height: 2px;
  background: var(--color-text-primary);
  border-radius: 2px;
  transition: all 0.3s ease;
}

@media (max-width: 768px) {
  .container {
    padding: 0 1rem;
  }
}
```

```css
/* src/components/Layout/Navigation.module.css */

.navigation {
  display: flex;
  align-items: center;
}

.navList {
  display: flex;
  gap: 2rem;
  list-style: none;
  margin: 0;
  padding: 0;
}

.navItem {
  margin: 0;
}

.navLink {
  text-decoration: none;
  color: var(--color-text-secondary);
  font-weight: 500;
  font-size: 0.95rem;
  transition: color 0.2s ease;
  padding: 0.5rem 0;
  display: inline-block;
  border-bottom: 2px solid transparent;
}

.navLink:hover {
  color: var(--color-text-primary);
}

.navLink.active {
  color: var(--color-primary);
  border-bottom-color: var(--color-primary);
}
```

```css
/* src/components/Layout/MobileMenu.module.css */

.backdrop {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  z-index: 1000;
  animation: fadeIn 0.2s ease;
}

.menu {
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  width: 280px;
  background: var(--color-bg-primary);
  z-index: 1001;
  display: flex;
  flex-direction: column;
  animation: slideIn 0.3s ease;
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes slideIn {
  from { transform: translateX(100%); }
  to { transform: translateX(0); }
}

.header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 1rem;
  border-bottom: 1px solid var(--color-border);
}

.title {
  font-size: 1.25rem;
  font-weight: 600;
  margin: 0;
}

.navigation {
  flex: 1;
  overflow-y: auto;
  padding: 1rem 0;
}

.navList {
  list-style: none;
  margin: 0;
  padding: 0;
}

.navItem {
  margin: 0;
}

.navLink {
  display: block;
  padding: 1rem 1.5rem;
  text-decoration: none;
  color: var(--color-text-secondary);
  font-weight: 500;
  font-size: 1rem;
  transition: all 0.2s ease;
}

.navLink:hover {
  background: var(--color-bg-hover);
  color: var(--color-text-primary);
}

.navLink.active {
  color: var(--color-primary);
  background: var(--color-primary-alpha);
}
```

```css
/* src/components/Layout/SkipLink.module.css */

.skipLink {
  position: absolute;
  top: -40px;
  left: 0;
  background: var(--color-primary);
  color: white;
  padding: 0.75rem 1.5rem;
  text-decoration: none;
  font-weight: 600;
  z-index: 10000;
  transition: top 0.2s ease;
}

.skipLink:focus {
  top: 0;
}
```

---

## Testing Requirements

```typescript
// src/components/Layout/AppLayout.test.tsx

import { render, screen } from '@testing-library/react';
import { BrowserRouter } from 'react-router-dom';
import { AppLayout } from './AppLayout';

function renderLayout(children: React.ReactNode) {
  return render(
    <BrowserRouter>
      <AppLayout>{children}</AppLayout>
    </BrowserRouter>
  );
}

describe('AppLayout', () => {
  it('renders header, main, and footer', () => {
    renderLayout(<div>Test content</div>);

    expect(screen.getByRole('banner')).toBeInTheDocument(); // header
    expect(screen.getByRole('main')).toBeInTheDocument();
    expect(screen.getByRole('contentinfo')).toBeInTheDocument(); // footer
  });

  it('renders skip link', () => {
    renderLayout(<div>Test content</div>);

    const skipLink = screen.getByText('Skip to main content');
    expect(skipLink).toBeInTheDocument();
    expect(skipLink).toHaveAttribute('href', '#main-content');
  });

  it('renders children in main content area', () => {
    renderLayout(<div>Test content</div>);

    const main = screen.getByRole('main');
    expect(main).toHaveTextContent('Test content');
  });
});
```

---

## Implementation Steps

1. **Day 1:** Build AppLayout, Header, Footer components
2. **Day 2:** Implement Navigation and MobileMenu
3. **Day 3:** Add responsive styles and accessibility features

---

## Validation Steps

- [ ] Layout renders on all screen sizes
- [ ] Navigation is keyboard accessible
- [ ] Mobile menu opens/closes
- [ ] Skip link works
- [ ] Header is sticky
- [ ] All tests pass
- [ ] Accessibility audit passes

---

**Last Updated:** 2025-12-23
